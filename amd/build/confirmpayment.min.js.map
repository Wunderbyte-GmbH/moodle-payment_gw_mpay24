{"version":3,"sources":["../src/confirmpayment.js"],"names":["init","token","itemid","customer","component","paymentarea","tid","ischeckstatus","Ajax","call","methodname","args","done","data","require","$","str","localStrings","get_strings","key","when","localizedEditStrings","ModalFactory","create","type","types","CANCEL","title","success","body","message","buttons","cancel","then","modal","root","getRoot","on","ModalEvents","location","href","url","show","catch","e","console","log","fail"],"mappings":"qMAuBA,OACA,OACA,O,mDAEO,GAAMA,CAAAA,CAAI,CAAG,SAACC,CAAD,CAAQC,CAAR,CAAgBC,CAAhB,CAA0BC,CAA1B,CAAqCC,CAArC,CAAkDC,CAAlD,CAAuDC,CAAvD,CAAyE,CAGzFC,UAAKC,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,0CADL,CAEPC,IAAI,CAAE,CACFV,KAAK,CAALA,CADE,CACKC,MAAM,CAANA,CADL,CACaC,QAAQ,CAARA,CADb,CACuBC,SAAS,CAATA,CADvB,CACkCC,WAAW,CAAXA,CADlC,CAC+CC,GAAG,CAAHA,CAD/C,CACoDC,aAAa,CAAbA,CADpD,CAFC,CAKPK,IAAI,CAAE,cAASC,CAAT,CAAe,CAGjBC,OAAO,CAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,CAC5BD,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASE,CAAT,CAAc,IAiB5BC,CAAAA,CAAY,CAAGD,CAAG,CAACE,WAAJ,CAfL,CACV,CACIC,GAAG,CAAE,SADT,CAEIf,SAAS,CAAE,cAFf,CADU,CAKV,CACIe,GAAG,CAAE,OADT,CAEIf,SAAS,CAAE,cAFf,CALU,CASV,CACIe,GAAG,CAAE,SADT,CAEIf,SAAS,CAAE,cAFf,CATU,CAeK,CAjBa,CAkBhCW,CAAC,CAACK,IAAF,CAAOH,CAAP,EAAqBL,IAArB,CAA0B,SAASS,CAAT,CAA+B,CAErDC,UAAaC,MAAb,CAAoB,CAChBC,IAAI,CAAEF,UAAaG,KAAb,CAAmBC,MADT,CAEhBC,KAAK,CAAE,IAAAd,CAAI,CAACe,OAAL,CAAuBP,CAAoB,CAAC,CAAD,CAA3C,CAAiDA,CAAoB,CAAC,CAAD,CAF5D,CAGhBQ,IAAI,CAAEhB,CAAI,CAACiB,OAHK,CAIhBC,OAAO,CAAE,CACLC,MAAM,CAAEX,CAAoB,CAAC,CAAD,CADvB,CAJO,CAApB,EAQCY,IARD,CAQM,SAASC,CAAT,CAAgB,CAClB,GAAIC,CAAAA,CAAI,CAAGD,CAAK,CAACE,OAAN,EAAX,CACAD,CAAI,CAACE,EAAL,CAAQC,UAAYN,MAApB,CAA4B,UAAW,CACnCO,QAAQ,CAACC,IAAT,CAAgB3B,CAAI,CAAC4B,GACxB,CAFD,EAGAP,CAAK,CAACQ,IAAN,GACA,QACH,CAfD,EAeGC,KAfH,CAeS,SAAAC,CAAC,CAAI,CAEVC,OAAO,CAACC,GAAR,CAAYF,CAAZ,CACH,CAlBD,CAoBH,CAtBD,CAuBH,CAzCM,CA0CV,CA3CM,CA8CV,CAtDM,CAuDPG,IAAI,CAAE,eAAW,CAGhB,CA1DM,CAAD,CAAV,CA6DH,CAhEM,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * mpay24 repository module to encapsulate all of the AJAX requests that can be sent for mpay24.\n *\n * @module     paygw_mpay24/confirmpayment\n * @copyright  2022 Georg Mai√üer <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\n\nexport const init = (token, itemid, customer, component, paymentarea, tid, ischeckstatus) => {\n\n\n    Ajax.call([{\n        methodname: \"paygw_mpay24_create_transaction_complete\",\n        args: {\n            token, itemid, customer, component, paymentarea, tid, ischeckstatus\n        },\n        done: function(data) {\n\n\n            require(['jquery'], function($) {\n                require(['core/str'], function(str) {\n\n                    var strings = [\n                        {\n                            key: 'success',\n                            component: 'paygw_mpay24'\n                        },\n                        {\n                            key: 'error',\n                            component: 'paygw_mpay24'\n                        },\n                        {\n                            key: 'proceed',\n                            component: 'paygw_mpay24',\n                        }\n                    ];\n\n                    var localStrings = str.get_strings(strings);\n                    $.when(localStrings).done(function(localizedEditStrings) {\n\n                        ModalFactory.create({\n                            type: ModalFactory.types.CANCEL,\n                            title: data.success == true ? localizedEditStrings[0] : localizedEditStrings[1],\n                            body: data.message,\n                            buttons: {\n                                cancel: localizedEditStrings[2],\n                            },\n                        })\n                        .then(function(modal) {\n                            var root = modal.getRoot();\n                            root.on(ModalEvents.cancel, function() {\n                                location.href = data.url;\n                            });\n                            modal.show();\n                            return true;\n                        }).catch(e => {\n                            // eslint-disable-next-line no-console\n                            console.log(e);\n                        });\n\n                    });\n                });\n            });\n\n\n        },\n        fail: function() {\n            // eslint-disable-next-line no-console\n            // console.log(\"ex:\" + ex);\n        },\n    }]);\n\n};"],"file":"confirmpayment.min.js"}