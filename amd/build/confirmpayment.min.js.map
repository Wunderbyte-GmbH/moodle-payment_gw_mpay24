{"version":3,"sources":["../src/confirmpayment.js"],"names":["init","token","itemid","customer","component","paymentarea","tid","ischeckstatus","Ajax","call","methodname","args","done","data","success","require","$","str","localStrings","get_strings","key","when","localizedEditStrings","ModalFactory","create","type","types","CANCEL","title","body","message","buttons","cancel","then","modal","root","getRoot","on","ModalEvents","location","href","url","show","catch","fail"],"mappings":"qMAuBA,OACA,OACA,O,mDAEO,GAAMA,CAAAA,CAAI,CAAG,SAACC,CAAD,CAAQC,CAAR,CAAgBC,CAAhB,CAA0BC,CAA1B,CAAqCC,CAArC,CAAkDC,CAAlD,CAAuDC,CAAvD,CAAyE,CAGzFC,UAAKC,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,0CADL,CAEPC,IAAI,CAAE,CACFV,KAAK,CAALA,CADE,CACKC,MAAM,CAANA,CADL,CACaC,QAAQ,CAARA,CADb,CACuBC,SAAS,CAATA,CADvB,CACkCC,WAAW,CAAXA,CADlC,CAC+CC,GAAG,CAAHA,CAD/C,CACoDC,aAAa,CAAbA,CADpD,CAFC,CAKPK,IAAI,CAAE,cAASC,CAAT,CAAe,CAEjB,GAAI,KAAAA,CAAI,CAACC,OAAT,CAA2B,CAEvBC,OAAO,CAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,CAC5BD,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASE,CAAT,CAAc,IAY5BC,CAAAA,CAAY,CAAGD,CAAG,CAACE,WAAJ,CAVL,CACV,CACIC,GAAG,CAAE,OADT,CAEIhB,SAAS,CAAE,cAFf,CADU,CAKV,CACIgB,GAAG,CAAE,SADT,CAEIhB,SAAS,CAAE,cAFf,CALU,CAUK,CAZa,CAahCY,CAAC,CAACK,IAAF,CAAOH,CAAP,EAAqBN,IAArB,CAA0B,SAASU,CAAT,CAA+B,CACrDC,UAAaC,MAAb,CAAoB,CAChBC,IAAI,CAAEF,UAAaG,KAAb,CAAmBC,MADT,CAEhBC,KAAK,CAAEN,CAAoB,CAAC,CAAD,CAFX,CAGhBO,IAAI,CAAEhB,CAAI,CAACiB,OAHK,CAIhBC,OAAO,CAAE,CACLC,MAAM,CAAEV,CAAoB,CAAC,CAAD,CADvB,CAJO,CAApB,EAQCW,IARD,CAQM,SAASC,CAAT,CAAgB,CAClB,GAAIC,CAAAA,CAAI,CAAGD,CAAK,CAACE,OAAN,EAAX,CACAD,CAAI,CAACE,EAAL,CAAQC,UAAYN,MAApB,CAA4B,UAAW,CACnCO,QAAQ,CAACC,IAAT,CAAgB3B,CAAI,CAAC4B,GACxB,CAFD,EAGAP,CAAK,CAACQ,IAAN,GACA,QACH,CAfD,EAeGC,KAfH,CAeS,EAfT,CAmBH,CApBD,CAqBH,CAlCM,CAmCV,CApCM,CAqCV,CAvCD,IAuCO,CACHJ,QAAQ,CAACC,IAAT,CAAgB3B,CAAI,CAAC4B,GACxB,CACJ,CAjDM,CAkDPG,IAAI,CAAE,eAAW,CAGhB,CArDM,CAAD,CAAV,CAwDH,CA3DM,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * mpay24 repository module to encapsulate all of the AJAX requests that can be sent for mpay24.\n *\n * @module     paygw_mpay24/confirmpayment\n * @copyright  2022 Georg Mai√üer <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\n\nexport const init = (token, itemid, customer, component, paymentarea, tid, ischeckstatus) => {\n\n\n    Ajax.call([{\n        methodname: \"paygw_mpay24_create_transaction_complete\",\n        args: {\n            token, itemid, customer, component, paymentarea, tid, ischeckstatus\n        },\n        done: function(data) {\n\n            if (data.success !== true) {\n\n                require(['jquery'], function($) {\n                    require(['core/str'], function(str) {\n\n                        var strings = [\n                            {\n                                key: 'error',\n                                component: 'paygw_mpay24'\n                            },\n                            {\n                                key: 'proceed',\n                                component: 'paygw_mpay24',\n                            }\n                        ];\n                        var localStrings = str.get_strings(strings);\n                        $.when(localStrings).done(function(localizedEditStrings) {\n                            ModalFactory.create({\n                                type: ModalFactory.types.CANCEL,\n                                title: localizedEditStrings[0],\n                                body: data.message,\n                                buttons: {\n                                    cancel: localizedEditStrings[1],\n                                },\n                            })\n                            .then(function(modal) {\n                                var root = modal.getRoot();\n                                root.on(ModalEvents.cancel, function() {\n                                    location.href = data.url;\n                                });\n                                modal.show();\n                                return true;\n                            }).catch({\n                                // eslint-disable-next-line no-console\n                                // console.log(e);\n                            });\n                        });\n                    });\n                });\n            } else {\n                location.href = data.url;\n            }\n        },\n        fail: function() {\n            // eslint-disable-next-line no-console\n            // console.log(\"ex:\" + ex);\n        },\n    }]);\n\n};"],"file":"confirmpayment.min.js"}